<html>
	<head>
		<title>Detail</title>
		<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
		<link rel="stylesheet" href="${url_prefix}/Themes/${orgTheme}/css/tips.css" type="text/css">
		<link rel="stylesheet" type="text/css" media="all" href="${url_prefix}/javascript/calendar/calendar-iflow.css" title="cal-iflow" />
		<link rel="stylesheet" type="text/css" href="${url_prefix}/javascript/yahoo/container/assets/skins/sam/container.css" />
		<link rel="stylesheet" type="text/css" href="${url_prefix}/javascript/yahoo/button/assets/skins/sam/button.css" />
		<link href="${url_prefix}/javascript/bootstrap/css/bootstrap.css" rel="stylesheet" type="text/css"/>
		<link rel="stylesheet" type="text/css" href="${url_prefix}/Themes/newflow/cssNew/main.css">

		<link rel="shortcut icon" href="images/ .ico" />
	<!--[if IE]>
		<link rel="stylesheet" href="Themes/${orgTheme}/css/iflow_ie.css" type="text/css">
	<![endif]-->

	<!--[if lt IE 7]>
		<style type="text/css">
			.icon_item { // append this style
				width:24px;
				height:24px;
			}
			img { behavior: url(iepngfix.htc) }
		</style>
	<![endif]-->

		<link type="text/css" rel="stylesheet" href="${url_prefix}/PublicFiles/default.css" />
		<script src="${url_prefix}/javascript/ajax_processing.js" type="text/javascript"></script>
		<script src="${url_prefix}/javascript/tabs.js" type="text/javascript"></script>
		<script src="${url_prefix}/javascript/iflow_main.js" type="text/javascript"></script>
		<script src="${url_prefix}/javascript/calendar/calendar.js" type="text/javascript"></script>
		<script src="${url_prefix}/javascript/calendar/lang/calendar-en_US.js" type="text/javascript"></script>
		<script src="${url_prefix}/javascript/calendar/calendar-setup.js" type="text/javascript"></script>
		<script src="${url_prefix}/javascript/mootools.js" type="text/javascript"></script>
		<script src="${url_prefix}/javascript/FormFunctions.js" type="text/javascript"></script>
		<script src="${url_prefix}/javascript/Stickman.MultiUpload.js" type="text/javascript"></script>
		<script src="${url_prefix}/javascript/jquery-1.10.2.js"></script>

	</head>
	
	<body>
	<style type="text/css">
		body {
			background: white;
		}
	</style>
		<div class="header_processo">
			<form name="user_proc_print" method="POST" action="$response.encodeURL(${url_prefix},'UserProcPrint')" target="_blank">
				<input type="hidden" name="flowid" value="$procFlowid">
				<input type="hidden" name="pid" value="$procPid">
				<input type="hidden" name="subpid" value="$procSubpid">				
			</form>
			<form action="form.jsp" id="dados" name="dados" method="POST" onsubmit="">
			#foreach($varName in $hmHidden.keySet())
				<input type="hidden" name="$varName" id="$varName" value="$hmHidden.get($varName)" />
			#end				
			<input type="hidden" name="procPreview" id="procPreview" value="true">
        <div class="title_cont" > Dados do processo n&ordm; $procPid (Pr&eacute;-visualiza&Ccedil;&atilde;o)</div>
        <div class="panel-body">
          <div class="form-horizontal" role="form">

			<!--div class="table"-->
			#if ($processDetail.isEmpty())
					<div class="alert alert-warning">
						$noDetail
					</div>
			#else
				#if (!$error.isEmpty())
					<div class="alert alert-warning">
						$error
					</div>
				#end
				#if ($procFlowid == 159)
					#set($varName="Área")
					#set($value = "")
					#if ($processDetail.get(${varName})!="")
						#set($value = $processDetail.get(${varName}))
					#end
					<input type="hidden" name="$processVarnames.get(${varName})" value="${value}">
					<div class="form-group">
						<label  class="col-sm-2 control-label">${varName}: </label>
						<div class="col-sm-8" style=" font-size: 14px; margin-top: 5px"> 
							#if ($processDetail.get(${varName})!="")
								$processDetail.get(${varName})
							#else
								&ltn&#227;o dispon&#237;vel&gt
							#end 
						</div>
					</div>
					#set($varName="Subárea")
					#set($value = "")
					#if ($processDetail.get(${varName})!="")
						#set($value = $processDetail.get(${varName}))
					#end
					<input type="hidden" name="$processVarnames.get(${varName})" value="${value}">
					<div class="form-group">
						<label  class="col-sm-2 control-label">${varName}: </label>
						<div class="col-sm-8" style=" font-size: 14px; margin-top: 5px"> 
							#if ($processDetail.get(${varName})!="")
								$processDetail.get(${varName})
							#else
								&ltn&#227;o dispon&#237;vel&gt
							#end 
						</div>
					</div>						
					#set($varName="Assunto")
					#set($value = "")
					#if ($processDetail.get(${varName})!="")
						#set($value = $processDetail.get(${varName}))
					#end
					<input type="hidden" name="$processVarnames.get(${varName})" value="${value}">
					<div class="form-group">
						<label  class="col-sm-2 control-label">${varName}: </label>
						<div class="col-sm-8" style=" font-size: 14px; margin-top: 5px"> 
							#if ($processDetail.get(${varName})!="")
								$processDetail.get(${varName})
							#else
								&ltn&#227;o dispon&#237;vel&gt
							#end 
						</div>
					</div>	
					#set($varName="Nome do Cliente Municipal")
					#set($value = "")
					#if ($processDetail.get(${varName})!="")
						#set($value = $processDetail.get(${varName}))
					#end
					<input type="hidden" name="$processVarnames.get(${varName})" value="${value}">
					<div class="form-group">
						<label  class="col-sm-2 control-label">${varName}: </label>
						<div class="col-sm-8" style=" font-size: 14px; margin-top: 5px"> 
							#if ($processDetail.get(${varName})!="")
								$processDetail.get(${varName})
							#else
								&ltn&#227;o dispon&#237;vel&gt
							#end 
						</div>
					</div>	
					#set($varName="NIF")
					#set($value = "")
					#if ($processDetail.get(${varName})!="")
						#set($value = $processDetail.get(${varName}))
					#end
					<input type="hidden" name="$processVarnames.get(${varName})" value="${value}">
					<div class="form-group">
						<label  class="col-sm-2 control-label">${varName}: </label>
						<div class="col-sm-8" style=" font-size: 14px; margin-top: 5px"> 
							#if ($processDetail.get(${varName})!="")
								$processDetail.get(${varName})
							#else
								&ltn&#227;o dispon&#237;vel&gt
							#end 
						</div>
					</div>	
					#set($varName="Tramitação Recente")
					#set($value = "")
					#if ($processDetail.get(${varName})!="")
						#set($value = $processDetail.get(${varName}))
					#end
					<input type="hidden" name="$processVarnames.get(${varName})" value="${value}">
					<div class="form-group">
						<label  class="col-sm-2 control-label">${varName}: </label>
						<div class="col-sm-8" style=" font-size: 14px; margin-top: 5px"> 
							#if ($processDetail.get(${varName})!="")
								$processDetail.get(${varName})
							#else
								&ltn&#227;o dispon&#237;vel&gt
							#end 
						</div>
					</div>

					#if ($user_name == "presidente" && $processDetail.get("Acções")!="" && (!($processDetail.get("Acção escolhida")!="") || $processDetail.get("Acção escolhida")=="pre_decisao" || $processDetail.get("Acção escolhida")=="parecer") )
						#set($valueName="Acção a executar")
						#set($varName="Decisão")
						#set($value = "")
						#if ($processDetail.get(${valueName})!="")
							#set($value = $processDetail.get(${valueName}))
						#end
						#set($sValues=$processDetail.get($varName))
						#set($sTexts=$processDetail.get("Decisão Texto"))
						#set($lValues=$sValues.split("] "))
						#set($lTexts=$sTexts.split("] "))
						#if ($lTexts != "")
							#set($listTexts = [])
							#foreach($text in $lTexts)
								#if($text.indexOf("<br>") > 0)
									#if ($listTexts.add($text.substring(0, $text.indexOf("<br>"))))
									#end
								#end
							#end

							#if ($lValues != "")
								<div class="form-group">
									<label  class="col-sm-2 control-label">${varName}: </label>
									<select class="txt  form-control pull-right combobox" style="width:250px;" name="$processVarnames.get(${valueName})"
											onchange="camouflageForm();document.dados.op.value='16';jQuery('#dados').submit();" >
									#set($idx = 0)
									<option value="Opção de decisão" >Opção de decisão</option>
									#foreach($val in $lValues)
										#if($val.indexOf("<br>") > 0)
											#set($val = $val.substring(0, $val.indexOf("<br>")))

											<option value="$val" 
											#if($val == $value)
												selected= "selected"
											#end
											>$listTexts.get($idx)</option>
											#set($idx = $idx+1)
										#end
									#end
									</select>
								</div>
							#end
						#end
					#end
				#else
					#foreach($varName in $processDetail.keySet())
						#set($value = "")
						#if ($processDetail.get(${varName})!="")
							#set($value = $processDetail.get(${varName}))
						#end
						<input type="hidden" name="$processVarnames.get(${varName})" value="${value}">	
						<div class="form-group">
							<label  class="col-sm-2 control-label">${varName}: </label>
							<div class="col-sm-8" style=" font-size: 14px; margin-top: 5px"> 
								#if ($processDetail.get(${varName})!="")
									$processDetail.get(${varName})
								#else
									&ltn&#227;o dispon&#237;vel&gt
								#end 
							</div>
						</div>
					#end
				#end
			#end
			#if($isForward)
				</div>
					<div class="form-group">
					<div class="col-sm-12" style=" font-size: 12px; margin-bottom: -10px;clear:both;"> Processo encaminhado, para utilizar deve aceder-lhe</div>
				</div>
			#else
				</div>
					<div class="form-group">
					<div class="col-sm-12" style=" font-size: 12px; margin-bottom: -10px;clear:both;"> Op&ccedil;&otilde;es dispon&iacute;veis </div>
				</div>
			#end
		    #if (!$processDetail.isEmpty())
				<fieldset class="submit">
				#foreach($button in $buttonList)
					#set($name=$button.get("name"))
					#set($id=$button.get("id"))
					#set($operation=$button.get("operation"))
					#set($tooltip=$button.get("tooltip"))
					#set($text=$button.get("text"))
					#set($buttonimagesrc=$button.get("buttonimagesrc"))
					#set($buttonimagealt=$button.get("buttonimagealt"))
					#set($hiddenfield=$button.get("hiddenfield"))
					&nbsp;

					<button type="submit" align="center" valign="center" class="btn btn-default" name="$name" value="$text" id="$id" 
						onClick="$operation;" title="&tooltip">
						$text 
					</button>
					&nbsp;
				#end
				</fieldset>
			#end
			</form>
		</div>
		</div>
	</div>
		<div id="preview" class="Preview">
			<button id="Aceder" style=" font-size: 24px; padding: 10px;" class="btn btn-default navbar-btn"
				onclick="javascript:openProcess($procFlowid, '$response.encodeURL($url_prefix,$uri)', 'flowid=$procFlowid&pid=$procPid&subpid=$procSubpid', false, 3);"> #*$act.get("runMax")*#
				Aceder
			</button>
		</div>
		<script language="JavaScript" type="text/javascript">
			var jQuery = jQuery.noConflict();
			jQuery("#dados").submit(function(e)
			{			
				var postData = jQuery(this).serializeArray();
				var formURL = jQuery(this).attr("action");
				jQuery.ajax(
				{
					url : formURL,
					type: "POST",
					data : postData,
					success:function(data, textStatus, jqXHR) {openProcess($procFlowid, '$response.encodeURL($url_prefix,$uri)', 'flowid=$procFlowid&pid=$procPid&subpid=$procSubpid', false, 3);},
					error: function(jqXHR, textStatus, errorThrown){openProcess($procFlowid, '$response.encodeURL($url_prefix,$uri)', 'flowid=$procFlowid&pid=$procPid&subpid=$procSubpid', false, 3);}
				});
			    e.preventDefault();	
			});
			
    	</script>
		</body>

</html>
